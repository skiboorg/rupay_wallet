"use strict";(globalThis["webpackChunkrupay_wallet"]=globalThis["webpackChunkrupay_wallet"]||[]).push([[389],{33389:(e,l,a)=>{a.r(l),a.d(l,{default:()=>H});var t=a(61758),u=a(38734),s=a(58790),n=a(59033),o=a(24029),d=a(29104),r=a(77474),i=a(77854),c=a(95522),v=a(94461),m=a(81750),p=function(e,l,a,t){function u(e){return e instanceof a?e:new a((function(l){l(e)}))}return new(a||(a=Promise))((function(a,s){function n(e){try{d(t.next(e))}catch(l){s(l)}}function o(e){try{d(t["throw"](e))}catch(l){s(l)}}function d(e){e.done?a(e.value):u(e.value).then(n,o)}d((t=t.apply(e,l||[])).next())}))};const b={key:0,class:""},k={key:1,class:""},f={class:"q-mb-sm text-caption text-bold"},_={key:2,class:""},g={class:"q-mb-sm text-caption text-bold"},y={key:3},F={class:"q-mb-sm text-caption"},h={class:"q-mb-sm text-caption"},w=500,A=(0,t.pM)({__name:"NonRub",props:{asset:{}},setup(e){const{toast:l,Icon:a,Color:o}=(0,c.d)(),{getFee:A,signTransaction:V}=(0,r.Z)(),q=(0,n.G)(),x=e,Q=[{label:"На адрес кошелька в другой сети",value:"address"}],W=(0,u.KR)(),R=(0,u.KR)(null),U=(0,u.KR)(!1),X=(0,u.KR)({asset:null,amount:null,wallet_rupay:null,address:null,network:null,card:null,phone:null,bank:null,fio:null,payment_details:null}),$=(0,t.EW)((()=>{if(x.asset)return parseFloat(parseFloat(x.asset.course)-parseFloat(x.asset.course)*parseFloat(x.asset.buy_commission)).toFixed(0)})),C=()=>p(this,void 0,void 0,(function*(){U.value=!U.value;const e=yield A(x.asset.key,R.value,"7JXmTnbwuDnpqQ3NwxwzhfGgDk223j13eP","Вывод","Вывод");if(e.success){const t=yield V(e.raw);if(m.log(t),t.success){let e="";if("address"===W.value.value)e=`\nЗапрос на вывод c кошелька ${q.address}:%0A\nНа адрес  ${X.value.address}%0A\nСеть ${X.value.network}%0A\nСумма ${R.value} ${x.asset.name}%0A`;else{let u;e=`\nЗапрос на вывод в РУБЛЯХ c кошелька ${q.address}:%0A\nСумма ${R.value} ${x.asset.name}%0A\nСумма в RUB исходная ${parseFloat(R.value*x.asset.course).toFixed(0)} %0A\nСумма в RUB к получению ${parseFloat(R.value*$.value).toFixed(0)} %0A\n`,u="card"===W.value.value?X.value.card:`${X.value.phone},${X.value.bank},${X.value.fio}`,m.log(e),m.log(u);const s=yield i.nodeApi.post("/api/data/rub_withdrawal",{asset_key:x.asset.key,wallet:q.address,amount:parseFloat(R.value*$.value).toFixed(0),amount_init:R.value,payment_details:u,payment_type:W.value.value,id:t.result.signature});s.data.success?l("Ваша заявка на вывод принята.<br>Ваши средства будут отправлены на указанные вами реквизиты<br> в течении нескольких дней",a.success,o.success):l(s.data.message.message,a.error,o.error)}yield v.A.get(`https://api.telegram.org/bot603507616:AAEmmGeaujFe_lqkw31HHSoh2EiAvVNtFA4/sendMessage?chat_id=-542426502\n  &text=${e}`),l("Запрос успешно отправлен",a.success,o.success)}}U.value=!U.value}));return(e,l)=>{const a=(0,t.g2)("q-select"),u=(0,t.g2)("q-input"),n=(0,t.g2)("q-btn"),o=(0,t.g2)("q-form");return(0,t.uX)(),(0,t.Wv)(o,{onSubmit:(0,d.D$)(C,["prevent"])},{default:(0,t.k6)((()=>{var o;return[(0,t.bF)(a,{outlined:"",options:Q,modelValue:W.value,"onUpdate:modelValue":l[0]||(l[0]=e=>W.value=e),behavior:"menu",label:"Выберите тип вывода","lazy-rules":"",rules:[e=>e||"Это обязательное поле"]},null,8,["modelValue","rules"]),W.value&&"address"===W.value.value?((0,t.uX)(),(0,t.CE)("div",b,[(0,t.bF)(u,{class:"q-mb-sm",outlined:"",modelValue:X.value.network,"onUpdate:modelValue":l[1]||(l[1]=e=>X.value.network=e),label:"Название сети","lazy-rules":"",rules:[e=>e&&e.length>0||"Это обязательное поле"]},null,8,["modelValue","rules"]),(0,t.bF)(u,{class:"q-mb-sm",outlined:"",modelValue:X.value.address,"onUpdate:modelValue":l[2]||(l[2]=e=>X.value.address=e),label:"Адрес кошелька","lazy-rules":"",rules:[e=>e&&e.length>0||"Это обязательное поле"]},null,8,["modelValue","rules"])])):(0,t.Q3)("",!0),W.value&&"card"===W.value.value?((0,t.uX)(),(0,t.CE)("div",k,[(0,t.bF)(u,{outlined:"",modelValue:X.value.card,"onUpdate:modelValue":l[3]||(l[3]=e=>X.value.card=e),mask:"#### #### #### ####","fill-mask":"#",label:"Введите номер карты","lazy-rules":"",rules:[e=>e&&e.length>0||"Это обязательное поле"]},null,8,["modelValue","rules"]),(0,t.Lk)("p",f,"Вы получите "+(0,s.v_)(parseFloat(R.value*$.value).toFixed(0))+" RUB",1)])):(0,t.Q3)("",!0),W.value&&"sbp"===W.value.value?((0,t.uX)(),(0,t.CE)("div",_,[(0,t.bF)(u,{outlined:"",modelValue:X.value.phone,"onUpdate:modelValue":l[4]||(l[4]=e=>X.value.phone=e),mask:"+7###########",label:"Введите номер телефона получателя","lazy-rules":"",rules:[e=>e&&e.length>0||"Это обязательное поле"]},null,8,["modelValue","rules"]),(0,t.bF)(u,{outlined:"",modelValue:X.value.bank,"onUpdate:modelValue":l[5]||(l[5]=e=>X.value.bank=e),label:"Введите название банка получателя","lazy-rules":"",rules:[e=>e&&e.length>0||"Это обязательное поле"]},null,8,["modelValue","rules"]),(0,t.bF)(u,{outlined:"",modelValue:X.value.fio,"onUpdate:modelValue":l[6]||(l[6]=e=>X.value.fio=e),label:"Введите ФИО получателя","lazy-rules":"",rules:[e=>e&&e.length>0||"Это обязательное поле"]},null,8,["modelValue","rules"]),(0,t.Lk)("p",g,"Вы получите "+(0,s.v_)(parseFloat(R.value*$.value).toFixed(0))+" RUB",1)])):(0,t.Q3)("",!0),W.value?((0,t.uX)(),(0,t.CE)("div",y,[(0,t.Lk)("p",F,"Ваш баланс "+(0,s.v_)((null===(o=e.asset.balance)||void 0===o?void 0:o.own)?e.asset.balance.own:"0")+" "+(0,s.v_)(e.asset.name),1),(0,t.Lk)("p",h,"Минимальная сумма вывода "+(0,s.v_)(w/$.value)+" "+(0,s.v_)(e.asset.name),1),(0,t.bF)(u,{class:"q-mb-md",outlined:"",modelValue:R.value,"onUpdate:modelValue":l[7]||(l[7]=e=>R.value=e),type:"number",step:"0.00001",label:"Сумма вывода"},null,8,["modelValue"]),(0,t.bF)(n,{color:"primary",loading:U.value,type:"submit",disable:!R.value||parseFloat(R.value*$.value)<w,unelevated:"","no-caps":"",class:"full-width q-py-md",label:"Отправить"},null,8,["loading","disable"])])):(0,t.Q3)("",!0)]})),_:1})}}});var V=a(21565),q=a(88515),x=a(68926),Q=a(69001),W=a(98582),R=a.n(W);const U=A,X=U;R()(A,"components",{QForm:V.A,QSelect:q.A,QInput:x.A,QBtn:Q.A});var $=function(e,l,a,t){function u(e){return e instanceof a?e:new a((function(l){l(e)}))}return new(a||(a=Promise))((function(a,s){function n(e){try{d(t.next(e))}catch(l){s(l)}}function o(e){try{d(t["throw"](e))}catch(l){s(l)}}function d(e){e.done?a(e.value):u(e.value).then(n,o)}d((t=t.apply(e,l||[])).next())}))};const C={key:0,class:"text-bold text-center"},E=(0,t.Lk)("p",{class:"text-grey-7 q-mb-sm"},"Выберите актив",-1),K=(0,t.pM)({__name:"index",setup(e){const{person:l,allAssets:a,address:d}=(0,n.G)(),r=(0,u.KR)(),c=(0,u.KR)("withdrawal"),v=(0,u.KR)([]);return(0,t.KC)((()=>$(this,void 0,void 0,(function*(){const e=yield i.nodeApi.get(`/api/data/withdrawal_history/${d}`);v.value=e.data})))),(e,n)=>{const d=(0,t.g2)("q-tab"),i=(0,t.g2)("q-tabs"),m=(0,t.g2)("q-separator"),p=(0,t.g2)("q-tab-panel"),b=(0,t.g2)("q-item-section"),k=(0,t.g2)("q-item"),f=(0,t.g2)("q-list"),_=(0,t.g2)("q-tab-panels"),g=(0,t.g2)("q-card"),y=(0,t.g2)("q-page"),F=(0,t.gN)("touch-swipe"),h=(0,t.gN)("auto-animate");return(0,t.bo)(((0,t.uX)(),(0,t.Wv)(y,{padding:"",class:"page"},{default:(0,t.k6)((()=>[(0,t.bF)(g,{flat:"",bordered:"",class:"full-height"},{default:(0,t.k6)((()=>[(0,t.bo)(((0,t.uX)(),(0,t.Wv)(i,{modelValue:c.value,"onUpdate:modelValue":n[0]||(n[0]=e=>c.value=e),"indicator-color":"transparent",class:"shadow-2",align:"justify","active-color":"dark","active-bg-color":"tab"},{default:(0,t.k6)((()=>[(0,t.bF)(d,{"no-caps":"",name:"withdrawal",label:"Вывод"}),(0,t.bF)(d,{"no-caps":"",name:"history",label:"История"})])),_:1},8,["modelValue"])),[[F]]),(0,t.bF)(m),(0,t.bF)(_,{modelValue:c.value,"onUpdate:modelValue":n[2]||(n[2]=e=>c.value=e),animated:""},{default:(0,t.k6)((()=>[(0,t.bF)(p,{name:"withdrawal"},{default:(0,t.k6)((()=>[(0,u.R1)(l)?((0,t.uX)(),(0,t.CE)(t.FK,{key:1},[E,(0,t.bF)(o.A,{class:"q-mb-md",assets:(0,u.R1)(a).filter((e=>e.can_withdrawal)),"is-withdrawal-list":"",onAssetSelected:n[1]||(n[1]=e=>r.value=e)},null,8,["assets"])],64)):((0,t.uX)(),(0,t.CE)("p",C,"Вывод доступен только верифицированным пользователям")),r.value?((0,t.uX)(),(0,t.Wv)(X,{key:2,asset:r.value},null,8,["asset"])):(0,t.Q3)("",!0)])),_:1}),(0,t.bF)(p,{name:"history"},{default:(0,t.k6)((()=>[(0,t.bF)(f,null,{default:(0,t.k6)((()=>[(0,t.bF)(k,null,{default:(0,t.k6)((()=>[(0,t.bF)(b,null,{default:(0,t.k6)((()=>[(0,t.eW)("Дата/Время")])),_:1}),(0,t.bF)(b,null,{default:(0,t.k6)((()=>[(0,t.eW)("Актив")])),_:1}),(0,t.bF)(b,null,{default:(0,t.k6)((()=>[(0,t.eW)("Сумма RUB")])),_:1}),(0,t.bF)(b,null,{default:(0,t.k6)((()=>[(0,t.eW)("Статус")])),_:1})])),_:1}),(0,t.bF)(m),((0,t.uX)(!0),(0,t.CE)(t.FK,null,(0,t.pI)(v.value,(e=>((0,t.uX)(),(0,t.Wv)(k,{key:e.id},{default:(0,t.k6)((()=>[(0,t.bF)(b,null,{default:(0,t.k6)((()=>[(0,t.eW)((0,s.v_)(new Date(e.created_at).toLocaleString()),1)])),_:2},1024),(0,t.bF)(b,null,{default:(0,t.k6)((()=>{var l;return[(0,t.eW)((0,s.v_)(null===(l=e.asset)||void 0===l?void 0:l.name),1)]})),_:2},1024),(0,t.bF)(b,null,{default:(0,t.k6)((()=>[(0,t.eW)((0,s.v_)(e.amount)+" RUB",1)])),_:2},1024),null===e.is_done?((0,t.uX)(),(0,t.Wv)(b,{key:0,class:"text-grey-5"},{default:(0,t.k6)((()=>[(0,t.eW)((0,s.v_)(e.status),1)])),_:2},1024)):(0,t.Q3)("",!0),!0===e.is_done?((0,t.uX)(),(0,t.Wv)(b,{key:1,class:"text-positive"},{default:(0,t.k6)((()=>[(0,t.eW)((0,s.v_)(e.status),1)])),_:2},1024)):(0,t.Q3)("",!0),!1===e.is_done?((0,t.uX)(),(0,t.Wv)(b,{key:2,class:"text-negative"},{default:(0,t.k6)((()=>[(0,t.eW)((0,s.v_)(e.status),1)])),_:2},1024)):(0,t.Q3)("",!0)])),_:2},1024)))),128))])),_:1})])),_:1})])),_:1},8,["modelValue"])])),_:1})])),_:1})),[[h]])}}});var T=a(33177),z=a(97569),S=a(64873),B=a(26721),L=a(37015),P=a(64082),I=a(63815),N=a(54514),D=a(75329),G=a(63418),j=a(35724);const M=K,H=M;R()(K,"components",{QPage:T.A,QCard:z.A,QTabs:S.A,QTab:B.A,QSeparator:L.A,QTabPanels:P.A,QTabPanel:I.A,QList:N.A,QItem:D.A,QItemSection:G.A}),R()(K,"directives",{TouchSwipe:j.A})}}]);